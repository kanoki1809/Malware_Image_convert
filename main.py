import streamlit as st
import numpy as np
import os
import subprocess
import array
import glob
from PIL import Image




def pe_to_image(file_path):
 

  pe = pefile.PE(file_path)
  image = PIL.Image.new("RGB", (pe.OPTIONAL_HEADER.SizeOfImage, pe.OPTIONAL_HEADER.SizeOfImage))
  for i in range(pe.OPTIONAL_HEADER.SizeOfImage):
    image.putpixel((i % pe.OPTIONAL_HEADER.SizeOfImage, i // pe.OPTIONAL_HEADER.SizeOfImage), pe.sections[0].get_data()[i])
  image = image.resize((pe.OPTIONAL_HEADER.SizeOfImage * dpi, pe.OPTIONAL_HEADER.SizeOfImage * dpi), Image.ANTIALIAS)
  return image
 

st.title('CONVERT PE FILE TO  IMAGE')

st.write('CHOOSE TYPE TO CONVERT')
type=st.radio('choose  depent',['file','folder'])

if type=='file':
   file = st.file_uploader('choose a pe file: ', type=([".exe", ".dll", ".ocx", ".sys", ".ime", ".cpl", ".bpl", ".ime", ".tlb", ".ocx", ".res", ".ax"]))
   image = pe_to_image(file)
   image.save("example.png")
   image.show()

 
 

else:
  uploaded_files = st.file_uploader("Upload your folder here...", accept_multiple_files=True, type=([".exe", ".dll", ".ocx", ".sys", ".ime", ".cpl", ".bpl", ".ime", ".tlb", ".ocx", ".res", ".ax"]))
  
  
